<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Waternet Arduboy</title>
    <meta name="author" content="Willems Davy" />
  </head>
  <script>
    if(window.parent)
    {
      window.document.addEventListener('keydown', (event) => {
        if(event.key == "Escape")
        {
          console.log('sended quit');
          window.parent.postMessage(JSON.stringify({name:"quit"}), "*");
        }
      });
      
      window.addEventListener('load', (event) => {
        console.log('sended start');
        window.parent.postMessage(JSON.stringify({name: "start"}), "*");
      });
    }
    </script>
    <script src="./gamecontroller.min.js" >
      gameControl.on('connect', function(gamepad) {
        gamepad.before('start', functions() {
          console.log('sended gamepad quit');
          window.parent.postMessage(JSON.stringify({name:"quit"}), "*");
        });
      });
    </script>
</head>
	<script>
		function setIframeSrc()
		{
      window.open = function(url, name, specs, replace) { // Do nothing, or do something smart... }
			const iframe = document.querySelector('#iframe');
			urlnotouch = "https://felipemanga.github.io/ProjectABE/?url=https://github.com/joyrider3774/waternet_arduboy/raw/main/distribution/waternet.hex&skin=BareFit&Color=FFFFFF";
			urltouch = "https://felipemanga.github.io/ProjectABE/?url=https://github.com/joyrider3774/waternet_arduboy/raw/main/distribution/waternet.hex&skin=Arduboy&Color=FFFFFFF";
			if (window.matchMedia("(any-pointer:coarse)").matches)
				iframe.setAttribute('src', urltouch);
			else
				iframe.setAttribute('src', urlnotouch);
      iframe.contentWindow.focus();
		}
		</script>
  <body onload="setIframeSrc();">
    <iframe allowfullscreen="0" id="iframe" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;" src="" />
  </body>
</html>
